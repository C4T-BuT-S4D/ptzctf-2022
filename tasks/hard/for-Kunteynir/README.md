# hard | forensics | Kunteynir

## Описание
Некто придумал гениальный план хранения файлов.

Его формат усложняет нам работу по определению полезных нагрузок в трафике.

Также с помощью этого формата общаются злые хакеры.

Помогите нам разобраться с ним, у нас нет кода, но есть пирмер файла, кажется передавалась картинка.

## Информация
Кастомный формат файла. Смысл в том, что файл разбивается на блоки случайной длины и они перемещиваются между собой

## Решение
1. Начинаем анализ формата с заголовка
2. Определяем, что первые 16 байт просто являются некоторой магией
3. Следующие 8 байт являются размером исходного файла, далее 8 байт нулей
4. Следующие 8 байт определяют размер таблицы смещений
5. Следующие 8 байт определяют оффсет по которому начинаются блоки
6. Парсим табличку и восстанавливаем оригинальную картинку в которой написан флаг

[скрипт](solve/solver.py)


## Флаг
`ptzctf{1_l1k3_bl0o0o0o0o0o0ck5_4nd_y0u?}`